from django.http import HttpResponse
from django.shortcuts import render
from milvus import Milvus, IndexType, MetricType, Status
from transformers import AutoModel, AutoTokenizer
import pandas as pd
import numpy as np


tokenizer = AutoTokenizer.from_pretrained("thunlp/Lawformer")
model = AutoModel.from_pretrained("thunlp/Lawformer")
df = pd.read_csv('../Web_Outer_File/my_test_demo.csv')

MiMap = {1668608354314194000: 1294989, 1668608354314194001: 1294990, 1668608354314194002: 1294993, 1668608354314194003: 1294994, 1668608354314194004: 1294995, 1668608354314194005: 1294996, 1668608354314194006: 1294997, 1668608354314194007: 1294998, 1668608354314194008: 1295000, 1668608354314194009: 1295001, 1668608354314194010: 1295002, 1668608354314194011: 1295003, 1668608354314194012: 1295005, 1668608354314194013: 1295006, 1668608354314194014: 1295008, 1668608354314194015: 1295010, 1668608354314194016: 1295012, 1668608354314194017: 1295013, 1668608354314194018: 1295015, 1668608354314194019: 1295016, 1668608354314194020: 1295017, 1668608354314194021: 1295018, 1668608354314194022: 1295019, 1668608354314194023: 1295020, 1668608354314194024: 1295021, 1668608354314194025: 1295022, 1668608354314194026: 1295023, 1668608354314194027: 1295024, 1668608354314194028: 1295025, 1668608354314194029: 1295026, 1668608354314194030: 1295027, 1668608354314194031: 1295028, 1668608354314194032: 1295029, 1668608354314194033: 1295030, 1668608354314194034: 1295032, 1668608354314194035: 1295033, 1668608354314194036: 1295035, 1668608354314194037: 1295037, 1668608354314194038: 1295038, 1668608354314194039: 1295040, 1668608354314194040: 1295041, 1668608354314194041: 1295042, 1668608354314194042: 1295043, 1668608354314194043: 1295044, 1668608354314194044: 1295046, 1668608354314194045: 1295047, 1668608354314194046: 1295048, 1668608354314194047: 1295049, 1668608354314194048: 1295050, 1668608354314194049: 1295051, 1668608354314194050: 1295052, 1668608354314194051: 1295054, 1668608354314194052: 1295056, 1668608354314194053: 1295057, 1668608354314194054: 1295058, 1668608354314194055: 1295059, 1668608354314194056: 1295060, 1668608354314194057: 1295061, 1668608354314194058: 1295062, 1668608354314194059: 1295063, 1668608354314194060: 1295064, 1668608354314194061: 1295065, 1668608354314194062: 1295066, 1668608354314194063: 1295067, 1668608354314194064: 1295068, 1668608354314194065: 1295069, 1668608354314194066: 1295070, 1668608354314194067: 1295073, 1668608354314194068: 1295074, 1668608354314194069: 1295075, 1668608354314194070: 1295076, 1668608354314194071: 1295077, 1668608354314194072: 1295078, 1668608354314194073: 1295079, 1668608354314194074: 1295080, 1668608354314194075: 1295081, 1668608354314194076: 1295082, 1668608354314194077: 1295083, 1668608354314194078: 1295085, 1668608354314194079: 1295087, 1668608354314194080: 1295088, 1668608354314194081: 1295089, 1668608354314194082: 1295090, 1668608354314194083: 1295091, 1668608354314194084: 1295092, 1668608354314194085: 1295093, 1668608354314194086: 1295096, 1668608354314194087: 1295097, 1668608354314194088: 1295098, 1668608354314194089: 1295099, 1668608354314194090: 1295100, 1668608354314194091: 1295103, 1668608354314194092: 1295104, 1668608354314194093: 1295105, 1668608354314194094: 1295106, 1668608354314194095: 1295108, 1668608354314194096: 1295111, 1668608354314194097: 1295112, 1668608354314194098: 1295113, 1668608354314194099: 1295114, 1668608354314194100: 1295115, 1668608354314194101: 1295116, 1668608354314194102: 1295117, 1668608354314194103: 1295118, 1668608354314194104: 1295119, 1668608354314194105: 1295120, 1668608354314194106: 1295121, 1668608354314194107: 1295122, 1668608354314194108: 1295123, 1668608354314194109: 1295124, 1668608354314194110: 1295125, 1668608354314194111: 1295126, 1668608354314194112: 1295127, 1668608354314194113: 1295128, 1668608354314194114: 1295129, 1668608354314194115: 1295131, 1668608354314194116: 1295132, 1668608354314194117: 1295134, 1668608354314194118: 1295135, 1668608354314194119: 1295136, 1668608354314194120: 1295137, 1668608354314194121: 1295138, 1668608354314194122: 1295139, 1668608354314194123: 1295140, 1668608354314194124: 1295141, 1668608354314194125: 1295142, 1668608354314194126: 1295143, 1668608354314194127: 1295144, 1668608354314194128: 1295146, 1668608354314194129: 1295147, 1668608354314194130: 1295148, 1668608354314194131: 1295149, 1668608354314194132: 1295151, 1668608354314194133: 1295152, 1668608354314194134: 1295153, 1668608354314194135: 1295156, 1668608354314194136: 1295157, 1668608354314194137: 1295158, 1668608354314194138: 1295159, 1668608354314194139: 1295161, 1668608354314194140: 1295162, 1668608354314194141: 1295163, 1668608354314194142: 1295165, 1668608354314194143: 1295166, 1668608354314194144: 1295167, 1668608354314194145: 1295168, 1668608354314194146: 1295169, 1668608354314194147: 1295171, 1668608354314194148: 1295173, 1668608354314194149: 1295174, 1668608354314194150: 1295175, 1668608354314194151: 1295176, 1668608354314194152: 1295178, 1668608354314194153: 1295179, 1668608354314194154: 1295181, 1668608354314194155: 1295182, 1668608354314194156: 1295186, 1668608354314194157: 1295187, 1668608354314194158: 1295188, 1668608354314194159: 1295189, 1668608354314194160: 1295191, 1668608354314194161: 1295192, 1668608354314194162: 1295194, 1668608354314194163: 1295195, 1668608354314194164: 1295197, 1668608354314194165: 1295198, 1668608354314194166: 1295199, 1668608354314194167: 1295200, 1668608354314194168: 1295201, 1668608354314194169: 1295202, 1668608354314194170: 1295203, 1668608354314194171: 1295204, 1668608354314194172: 1295205, 1668608354314194173: 1295206, 1668608354314194174: 1295210, 1668608354314194175: 1295212, 1668608354314194176: 1295214, 1668608354314194177: 1295215, 1668608354314194178: 1295216, 1668608354314194179: 1295217, 1668608354314194180: 1295218, 1668608354314194181: 1295219, 1668608354314194182: 1295220, 1668608354314194183: 1295221, 1668608354314194184: 1295223, 1668608354314194185: 1295224, 1668608354314194186: 1295225, 1668608354314194187: 1295226, 1668608354314194188: 1295227, 1668608354314194189: 1295228, 1668608354314194190: 1295229, 1668608354314194191: 1295230, 1668608354314194192: 1295231, 1668608354314194193: 1295232, 1668608354314194194: 1295234, 1668608354314194195: 1295235, 1668608354314194196: 1295236, 1668608354314194197: 1295237, 1668608354314194198: 1295238, 1668608354314194199: 1295240, 1668608354314194200: 1295244, 1668608354314194201: 1295245, 1668608354314194202: 1295247, 1668608354314194203: 1295248, 1668608354314194204: 1295249, 1668608354314194205: 1295251, 1668608354314194206: 1295252, 1668608354314194207: 1295254, 1668608354314194208: 1295255, 1668608354314194209: 1295256, 1668608354314194210: 1295257, 1668608354314194211: 1295259, 1668608354314194212: 1295260, 1668608354314194213: 1295261, 1668608354314194214: 1295262, 1668608354314194215: 1295263, 1668608354314194216: 1295264, 1668608354314194217: 1295265, 1668608354314194218: 1295266, 1668608354314194219: 1295267, 1668608354314194220: 1295268, 1668608354314194221: 1295271, 1668608354314194222: 1295272, 1668608354314194223: 1295273, 1668608354314194224: 1295275, 1668608354314194225: 1295278, 1668608354314194226: 1295279, 1668608354314194227: 1295281, 1668608354314194228: 1295282, 1668608354314194229: 1295283, 1668608354314194230: 1295285, 1668608354314194231: 1295287, 1668608354314194232: 1295288, 1668608354314194233: 1295289, 1668608354314194234: 1295290, 1668608354314194235: 1295291, 1668608354314194236: 1295292, 1668608354314194237: 1295296, 1668608354314194238: 1295297, 1668608354314194239: 1295298, 1668608354314194240: 1295299, 1668608354314194241: 1295300, 1668608354314194242: 1295301, 1668608354314194243: 1295302, 1668608354314194244: 1295303, 1668608354314194245: 1295305, 1668608354314194246: 1295306, 1668608354314194247: 1295307, 1668608354314194248: 1295308, 1668608354314194249: 1295309, 1668608354314194250: 1295312, 1668608354314194251: 1295313, 1668608354314194252: 1295314, 1668608354314194253: 1295315, 1668608354314194254: 1295316, 1668608354314194255: 1295317, 1668608354314194256: 1295318, 1668608354314194257: 1295319, 1668608354314194258: 1295320, 1668608354314194259: 1295322, 1668608354314194260: 1295323, 1668608354314194261: 1295324, 1668608354314194262: 1295327, 1668608354314194263: 1295328, 1668608354314194264: 1295329, 1668608354314194265: 1295332, 1668608354314194266: 1295333, 1668608354314194267: 1295334, 1668608354314194268: 1295335, 1668608354314194269: 1295336, 1668608354314194270: 1295337, 1668608354314194271: 1295338, 1668608354314194272: 1295339, 1668608354314194273: 1295340, 1668608354314194274: 1295341, 1668608354314194275: 1295342, 1668608354314194276: 1295343, 1668608354314194277: 1295344, 1668608354314194278: 1295345, 1668608354314194279: 1295346, 1668608354314194280: 1295347, 1668608354314194281: 1295348, 1668608354314194282: 1295351, 1668608354314194283: 1295353, 1668608354314194284: 1295355, 1668608354314194285: 1295356, 1668608354314194286: 1295357, 1668608354314194287: 1295358, 1668608354314194288: 1295359, 1668608354314194289: 1295360, 1668608354314194290: 1295361, 1668608354314194291: 1295363, 1668608354314194292: 1295364, 1668608354314194293: 1295365, 1668608354314194294: 1295366, 1668608354314194295: 1295367, 1668608354314194296: 1295369, 1668608354314194297: 1295370, 1668608354314194298: 1295371, 1668608354314194299: 1295372, 1668608354314194300: 1295373, 1668608354314194301: 1295374, 1668608354314194302: 1295375, 1668608354314194303: 1295376, 1668608354314194304: 1295377, 1668608354314194305: 1295379, 1668608354314194306: 1295380, 1668608354314194307: 1295381, 1668608354314194308: 1295382, 1668608354314194309: 1295383, 1668608354314194310: 1295386, 1668608354314194311: 1295387, 1668608354314194312: 1295388, 1668608354314194313: 1295389, 1668608354314194314: 1295390, 1668608354314194315: 1295391, 1668608354314194316: 1295392, 1668608354314194317: 1295393, 1668608354314194318: 1295394, 1668608354314194319: 1295395, 1668608354314194320: 1295396, 1668608354314194321: 1295398, 1668608354314194322: 1295399, 1668608354314194323: 1295400, 1668608354314194324: 1295401, 1668608354314194325: 1295402, 1668608354314194326: 1295403, 1668608354314194327: 1295404, 1668608354314194328: 1295405, 1668608354314194329: 1295406, 1668608354314194330: 1295407, 1668608354314194331: 1295408, 1668608354314194332: 1295409, 1668608354314194333: 1295410, 1668608354314194334: 1295412, 1668608354314194335: 1295413, 1668608354314194336: 1295415, 1668608354314194337: 1295416, 1668608354314194338: 1295417, 1668608354314194339: 1295418, 1668608354314194340: 1295421, 1668608354314194341: 1295424, 1668608354314194342: 1295425, 1668608354314194343: 1295426, 1668608354314194344: 1295427, 1668608354314194345: 1295429, 1668608354314194346: 1295430, 1668608354314194347: 1295431, 1668608354314194348: 1295432, 1668608354314194349: 1295433, 1668608354314194350: 1295434, 1668608354314194351: 1295435, 1668608354314194352: 1295436, 1668608354314194353: 1295437, 1668608354314194354: 1295439, 1668608354314194355: 1295441, 1668608354314194356: 1295442, 1668608354314194357: 1295444, 1668608354314194358: 1295445, 1668608354314194359: 1295446, 1668608354314194360: 1295447, 1668608354314194361: 1295448, 1668608354314194362: 1295449, 1668608354314194363: 1295450, 1668608354314194364: 1295451, 1668608354314194365: 1295453, 1668608354314194366: 1295454, 1668608354314194367: 1295457, 1668608354314194368: 1295458, 1668608354314194369: 1295460, 1668608354314194370: 1295461, 1668608354314194371: 1295462, 1668608354314194372: 1295463, 1668608354314194373: 1295464, 1668608354314194374: 1295465, 1668608354314194375: 1295466, 1668608354314194376: 1295468, 1668608354314194377: 1295470, 1668608354314194378: 1295471, 1668608354314194379: 1295472, 1668608354314194380: 1295473, 1668608354314194381: 1295474, 1668608354314194382: 1295475, 1668608354314194383: 1295476, 1668608354314194384: 1295477, 1668608354314194385: 1295478, 1668608354314194386: 1295479, 1668608354314194387: 1295480, 1668608354314194388: 1295481, 1668608354314194389: 1295482, 1668608354314194390: 1295483, 1668608354314194391: 1295484, 1668608354314194392: 1295485, 1668608354314194393: 1295486, 1668608354314194394: 1295488, 1668608354314194395: 1295489, 1668608354314194396: 1295491, 1668608354314194397: 1295492, 1668608354314194398: 1295494, 1668608354314194399: 1295495, 1668608354314194400: 1295496, 1668608354314194401: 1295497, 1668608354314194402: 1295501, 1668608354314194403: 1295502, 1668608354314194404: 1295503, 1668608354314194405: 1295504, 1668608354314194406: 1295505, 1668608354314194407: 1295507, 1668608354314194408: 1295509, 1668608354314194409: 1295510, 1668608354314194410: 1295511, 1668608354314194411: 1295512, 1668608354314194412: 1295513, 1668608354314194413: 1295514, 1668608354314194414: 1295515, 1668608354314194415: 1295516, 1668608354314194416: 1295517, 1668608354314194417: 1295518, 1668608354314194418: 1295519, 1668608354314194419: 1295520, 1668608354314194420: 1295522, 1668608354314194421: 1295523, 1668608354314194422: 1295524, 1668608354314194423: 1295529, 1668608354314194424: 1295531, 1668608354314194425: 1295532, 1668608354314194426: 1295533, 1668608354314194427: 1295534, 1668608354314194428: 1295535, 1668608354314194429: 1295536, 1668608354314194430: 1295539, 1668608354314194431: 1295540, 1668608354314194432: 1295542, 1668608354314194433: 1295543, 1668608354314194434: 1295544, 1668608354314194435: 1295545, 1668608354314194436: 1295546, 1668608354314194437: 1295547, 1668608354314194438: 1295548, 1668608354314194439: 1295549, 1668608354314194440: 1295551, 1668608354314194441: 1295552, 1668608354314194442: 1295554, 1668608354314194443: 1295555, 1668608354314194444: 1295557, 1668608354314194445: 1295558, 1668608354314194446: 1295559, 1668608354314194447: 1295560, 1668608354314194448: 1295561, 1668608354314194449: 1295562, 1668608354314194450: 1295564, 1668608354314194451: 1295565, 1668608354314194452: 1295566, 1668608354314194453: 1295568, 1668608354314194454: 1295569, 1668608354314194455: 1295570, 1668608354314194456: 1295571, 1668608354314194457: 1295572, 1668608354314194458: 1295574, 1668608354314194459: 1295575, 1668608354314194460: 1295577, 1668608354314194461: 1295578, 1668608354314194462: 1295579, 1668608354314194463: 1295580, 1668608354314194464: 1295582, 1668608354314194465: 1295586, 1668608354314194466: 1295587, 1668608354314194467: 1295589, 1668608354314194468: 1295593, 1668608354314194469: 1295595, 1668608354314194470: 1295596, 1668608354314194471: 1295597, 1668608354314194472: 1295598, 1668608354314194473: 1295600, 1668608354314194474: 1295601, 1668608354314194475: 1295602, 1668608354314194476: 1295604, 1668608354314194477: 1295605, 1668608354314194478: 1295607, 1668608354314194479: 1295608, 1668608354314194480: 1295609, 1668608354314194481: 1295611, 1668608354314194482: 1295613, 1668608354314194483: 1295614, 1668608354314194484: 1295615, 1668608354314194485: 1295616, 1668608354314194486: 1295617, 1668608354314194487: 1295618, 1668608354314194488: 1295619, 1668608354314194489: 1295620, 1668608354314194490: 1295622, 1668608354314194491: 1295623, 1668608354314194492: 1295626, 1668608354314194493: 1295628, 1668608354314194494: 1295629, 1668608354314194495: 1295630, 1668608354314194496: 1295631, 1668608354314194497: 1295632, 1668608354314194498: 1295633, 1668608354314194499: 1295635, 1668608354314194500: 1295636, 1668608354314194501: 1295637, 1668608354314194502: 1295638, 1668608354314194503: 1295639, 1668608354314194504: 1295640, 1668608354314194505: 1295641, 1668608354314194506: 1295642, 1668608354314194507: 1295643, 1668608354314194508: 1295644, 1668608354314194509: 1295647, 1668608354314194510: 1295648, 1668608354314194511: 1295649, 1668608354314194512: 1295650, 1668608354314194513: 1295652, 1668608354314194514: 1295653, 1668608354314194515: 1295654, 1668608354314194516: 1295655, 1668608354314194517: 1295656, 1668608354314194518: 1295657, 1668608354314194519: 1295658, 1668608354314194520: 1295659, 1668608354314194521: 1295660, 1668608354314194522: 1295661, 1668608354314194523: 1295662, 1668608354314194524: 1295663, 1668608354314194525: 1295664, 1668608354314194526: 1295666, 1668608354314194527: 1295667, 1668608354314194528: 1295669, 1668608354314194529: 1295670, 1668608354314194530: 1295671, 1668608354314194531: 1295672, 1668608354314194532: 1295674, 1668608354314194533: 1295675, 1668608354314194534: 1295676, 1668608354314194535: 1295677, 1668608354314194536: 1295678, 1668608354314194537: 1295679, 1668608354314194538: 1295680, 1668608354314194539: 1295681, 1668608354314194540: 1295682, 1668608354314194541: 1295683, 1668608354314194542: 1295684, 1668608354314194543: 1295686, 1668608354314194544: 1295687, 1668608354314194545: 1295688, 1668608354314194546: 1295689, 1668608354314194547: 1295691, 1668608354314194548: 1295693, 1668608354314194549: 1295694, 1668608354314194550: 1295695, 1668608354314194551: 1295696, 1668608354314194552: 1295697, 1668608354314194553: 1295698, 1668608354314194554: 1295701, 1668608354314194555: 1295702, 1668608354314194556: 1295703, 1668608354314194557: 1295707, 1668608354314194558: 1295708, 1668608354314194559: 1295710, 1668608354314194560: 1295711, 1668608354314194561: 1295712, 1668608354314194562: 1295713, 1668608354314194563: 1295714, 1668608354314194564: 1295716, 1668608354314194565: 1295717, 1668608354314194566: 1295719, 1668608354314194567: 1295722, 1668608354314194568: 1295723, 1668608354314194569: 1295724, 1668608354314194570: 1295725, 1668608354314194571: 1295726, 1668608354314194572: 1295727, 1668608354314194573: 1295728, 1668608354314194574: 1295729, 1668608354314194575: 1295730, 1668608354314194576: 1295731, 1668608354314194577: 1295733, 1668608354314194578: 1295734, 1668608354314194579: 1295735, 1668608354314194580: 1295736, 1668608354314194581: 1295737, 1668608354314194582: 1295738, 1668608354314194583: 1295740, 1668608354314194584: 1295741, 1668608354314194585: 1295742, 1668608354314194586: 1295744, 1668608354314194587: 1295747, 1668608354314194588: 1295748, 1668608354314194589: 1295749, 1668608354314194590: 1295750, 1668608354314194591: 1295752, 1668608354314194592: 1295753, 1668608354314194593: 1295754, 1668608354314194594: 1295755, 1668608354314194595: 1295757, 1668608354314194596: 1295758, 1668608354314194597: 1295759, 1668608354314194598: 1295761, 1668608354314194599: 1295762, 1668608354314194600: 1295763, 1668608354314194601: 1295764, 1668608354314194602: 1295765, 1668608354314194603: 1295766, 1668608354314194604: 1295768, 1668608354314194605: 1295769, 1668608354314194606: 1295771, 1668608354314194607: 1295772, 1668608354314194608: 1295773, 1668608354314194609: 1295774, 1668608354314194610: 1295777, 1668608354314194611: 1295779, 1668608354314194612: 1295781, 1668608354314194613: 1295782, 1668608354314194614: 1295783, 1668608354314194615: 1295784, 1668608354314194616: 1295785, 1668608354314194617: 1295786, 1668608354314194618: 1295787, 1668608354314194619: 1295788, 1668608354314194620: 1295789, 1668608354314194621: 1295790, 1668608354314194622: 1295791, 1668608354314194623: 1295792, 1668608354314194624: 1295793, 1668608354314194625: 1295794, 1668608354314194626: 1295795, 1668608354314194627: 1295797, 1668608354314194628: 1295798, 1668608354314194629: 1295799, 1668608354314194630: 1295800, 1668608354314194631: 1295803, 1668608354314194632: 1295804, 1668608354314194633: 1295806, 1668608354314194634: 1295807, 1668608354314194635: 1295808, 1668608354314194636: 1295810, 1668608354314194637: 1295811, 1668608354314194638: 1295812, 1668608354314194639: 1295814, 1668608354314194640: 1295815, 1668608354314194641: 1295816, 1668608354314194642: 1295817, 1668608354314194643: 1295818, 1668608354314194644: 1295819, 1668608354314194645: 1295820, 1668608354314194646: 1295821, 1668608354314194647: 1295822, 1668608354314194648: 1295823, 1668608354314194649: 1295824, 1668608354314194650: 1295825, 1668608354314194651: 1295826, 1668608354314194652: 1295827, 1668608354314194653: 1295828, 1668608354314194654: 1295829, 1668608354314194655: 1295830, 1668608354314194656: 1295831, 1668608354314194657: 1295832, 1668608354314194658: 1295835, 1668608354314194659: 1295836, 1668608354314194660: 1295837, 1668608354314194661: 1295838, 1668608354314194662: 1295840, 1668608354314194663: 1295844, 1668608354314194664: 1295846, 1668608354314194665: 1295847, 1668608354314194666: 1295849, 1668608354314194667: 1295850, 1668608354314194668: 1295851, 1668608354314194669: 1295852, 1668608354314194670: 1295853, 1668608354314194671: 1295854, 1668608354314194672: 1295855, 1668608354314194673: 1295857, 1668608354314194674: 1295858, 1668608354314194675: 1295859, 1668608354314194676: 1295860, 1668608354314194677: 1295862, 1668608354314194678: 1295864, 1668608354314194679: 1295865, 1668608354314194680: 1295866, 1668608354314194681: 1295867, 1668608354314194682: 1295868, 1668608354314194683: 1295869, 1668608354314194684: 1295870, 1668608354314194685: 1295871, 1668608354314194686: 1295872, 1668608354314194687: 1295873, 1668608354314194688: 1295874, 1668608354314194689: 1295875, 1668608354314194690: 1295877, 1668608354314194691: 1295878, 1668608354314194692: 1295879, 1668608354314194693: 1295880, 1668608354314194694: 1295882, 1668608354314194695: 1295883, 1668608354314194696: 1295884, 1668608354314194697: 1295885, 1668608354314194698: 1295887, 1668608354314194699: 1295889, 1668608354314194700: 1295890, 1668608354314194701: 1295891, 1668608354314194702: 1295893, 1668608354314194703: 1295894, 1668608354314194704: 1295895, 1668608354314194705: 1295896, 1668608354314194706: 1295897, 1668608354314194707: 1295899, 1668608354314194708: 1295901, 1668608354314194709: 1295902, 1668608354314194710: 1295903, 1668608354314194711: 1295904, 1668608354314194712: 1295905, 1668608354314194713: 1295906, 1668608354314194714: 1295911, 1668608354314194715: 1295912, 1668608354314194716: 1295915, 1668608354314194717: 1295916, 1668608354314194718: 1295917, 1668608354314194719: 1295918, 1668608354314194720: 1295919, 1668608354314194721: 1295920, 1668608354314194722: 1295921, 1668608354314194723: 1295924, 1668608354314194724: 1295925, 1668608354314194725: 1295926, 1668608354314194726: 1295928, 1668608354314194727: 1295929, 1668608354314194728: 1295930, 1668608354314194729: 1295931, 1668608354314194730: 1295932, 1668608354314194731: 1295933, 1668608354314194732: 1295934, 1668608354314194733: 1295935, 1668608354314194734: 1295936, 1668608354314194735: 1295937, 1668608354314194736: 1295938, 1668608354314194737: 1295939, 1668608354314194738: 1295941, 1668608354314194739: 1295942, 1668608354314194740: 1295943, 1668608354314194741: 1295944, 1668608354314194742: 1295945, 1668608354314194743: 1295947, 1668608354314194744: 1295948, 1668608354314194745: 1295949, 1668608354314194746: 1295950, 1668608354314194747: 1295952, 1668608354314194748: 1295954, 1668608354314194749: 1295955, 1668608354314194750: 1295956, 1668608354314194751: 1295958, 1668608354314194752: 1295959, 1668608354314194753: 1295961, 1668608354314194754: 1295962, 1668608354314194755: 1295963, 1668608354314194756: 1295964, 1668608354314194757: 1295965, 1668608354314194758: 1295966, 1668608354314194759: 1295967, 1668608354314194760: 1295968, 1668608354314194761: 1295969, 1668608354314194762: 1295970, 1668608354314194763: 1295971, 1668608354314194764: 1295972, 1668608354314194765: 1295973, 1668608354314194766: 1295974, 1668608354314194767: 1295975, 1668608354314194768: 1295976, 1668608354314194769: 1295977, 1668608354314194770: 1295978, 1668608354314194771: 1295980, 1668608354314194772: 1295981, 1668608354314194773: 1295982, 1668608354314194774: 1295983, 1668608354314194775: 1295985, 1668608354314194776: 1295986, 1668608354314194777: 1295987, 1668608354314194778: 1295988, 1668608354314194779: 1295990, 1668608354314194780: 1295992, 1668608354314194781: 1295993, 1668608354314194782: 1295996, 1668608354314194783: 1295997, 1668608354314194784: 1295998, 1668608354314194785: 1296000, 1668608354314194786: 1296002, 1668608354314194787: 1296003, 1668608354314194788: 1296005, 1668608354314194789: 1296006, 1668608354314194790: 1296007, 1668608354314194791: 1296010, 1668608354314194792: 1296011, 1668608354314194793: 1296012, 1668608354314194794: 1296013, 1668608354314194795: 1296014, 1668608354314194796: 1296015, 1668608354314194797: 1296017, 1668608354314194798: 1296018, 1668608354314194799: 1296019, 1668608354314194800: 1296020, 1668608354314194801: 1296021, 1668608354314194802: 1296022, 1668608354314194803: 1296023, 1668608354314194804: 1296024, 1668608354314194805: 1296025, 1668608354314194806: 1296026, 1668608354314194807: 1296027, 1668608354314194808: 1296028, 1668608354314194809: 1296029, 1668608354314194810: 1296030, 1668608354314194811: 1296032, 1668608354314194812: 1296033, 1668608354314194813: 1296035, 1668608354314194814: 1296036, 1668608354314194815: 1296037, 1668608354314194816: 1296038, 1668608354314194817: 1296039, 1668608354314194818: 1296040, 1668608354314194819: 1296042, 1668608354314194820: 1296043, 1668608354314194821: 1296045, 1668608354314194822: 1296046, 1668608354314194823: 1296047, 1668608354314194824: 1296048, 1668608354314194825: 1296049, 1668608354314194826: 1296050, 1668608354314194827: 1296052, 1668608354314194828: 1296053, 1668608354314194829: 1296054, 1668608354314194830: 1296055, 1668608354314194831: 1296057, 1668608354314194832: 1296058, 1668608354314194833: 1296060, 1668608354314194834: 1296062, 1668608354314194835: 1296063, 1668608354314194836: 1296064, 1668608354314194837: 1296065, 1668608354314194838: 1296066, 1668608354314194839: 1296067, 1668608354314194840: 1296068, 1668608354314194841: 1296069, 1668608354314194842: 1296071, 1668608354314194843: 1296073, 1668608354314194844: 1296074, 1668608354314194845: 1296075, 1668608354314194846: 1296076, 1668608354314194847: 1296077, 1668608354314194848: 1296078, 1668608354314194849: 1296079, 1668608354314194850: 1296080, 1668608354314194851: 1296082, 1668608354314194852: 1296083, 1668608354314194853: 1296084, 1668608354314194854: 1296087, 1668608354314194855: 1296088, 1668608354314194856: 1296090, 1668608354314194857: 1296092, 1668608354314194858: 1296094, 1668608354314194859: 1296095, 1668608354314194860: 1296096, 1668608354314194861: 1296097, 1668608354314194862: 1296099, 1668608354314194863: 1296100, 1668608354314194864: 1296101, 1668608354314194865: 1296102, 1668608354314194866: 1296104, 1668608354314194867: 1296105, 1668608354314194868: 1296106, 1668608354314194869: 1296107, 1668608354314194870: 1296108, 1668608354314194871: 1296109, 1668608354314194872: 1296110, 1668608354314194873: 1296111, 1668608354314194874: 1296114, 1668608354314194875: 1296115, 1668608354314194876: 1296118, 1668608354314194877: 1296119, 1668608354314194878: 1296121, 1668608354314194879: 1296122, 1668608354314194880: 1296125, 1668608354314194881: 1296126, 1668608354314194882: 1296127, 1668608354314194883: 1296128, 1668608354314194884: 1296129, 1668608354314194885: 1296130, 1668608354314194886: 1296131, 1668608354314194887: 1296133, 1668608354314194888: 1296134, 1668608354314194889: 1296135, 1668608354314194890: 1296136, 1668608354314194891: 1296137, 1668608354314194892: 1296138, 1668608354314194893: 1296139, 1668608354314194894: 1296140, 1668608354314194895: 1296141, 1668608354314194896: 1296142, 1668608354314194897: 1296143, 1668608354314194898: 1296144, 1668608354314194899: 1296145, 1668608354314194900: 1296147, 1668608354314194901: 1296148, 1668608354314194902: 1296149, 1668608354314194903: 1296152, 1668608354314194904: 1296154, 1668608354314194905: 1296155, 1668608354314194906: 1296156, 1668608354314194907: 1296157, 1668608354314194908: 1296158, 1668608354314194909: 1296161, 1668608354314194910: 1296162, 1668608354314194911: 1296163, 1668608354314194912: 1296164, 1668608354314194913: 1296168, 1668608354314194914: 1296169, 1668608354314194915: 1296170, 1668608354314194916: 1296171, 1668608354314194917: 1296172, 1668608354314194918: 1296173, 1668608354314194919: 1296175, 1668608354314194920: 1296176, 1668608354314194921: 1296177, 1668608354314194922: 1296179, 1668608354314194923: 1296184, 1668608354314194924: 1296185, 1668608354314194925: 1296187, 1668608354314194926: 1296189, 1668608354314194927: 1296190, 1668608354314194928: 1296192, 1668608354314194929: 1296193, 1668608354314194930: 1296195, 1668608354314194931: 1296197, 1668608354314194932: 1296199, 1668608354314194933: 1296200, 1668608354314194934: 1296201, 1668608354314194935: 1296202, 1668608354314194936: 1296203, 1668608354314194937: 1296204, 1668608354314194938: 1296206, 1668608354314194939: 1296207, 1668608354314194940: 1296208, 1668608354314194941: 1296209, 1668608354314194942: 1296210, 1668608354314194943: 1296211, 1668608354314194944: 1296212, 1668608354314194945: 1296213, 1668608354314194946: 1296217, 1668608354314194947: 1296218, 1668608354314194948: 1296219, 1668608354314194949: 1296220, 1668608354314194950: 1296221, 1668608354314194951: 1296222, 1668608354314194952: 1296223, 1668608354314194953: 1296225, 1668608354314194954: 1296226, 1668608354314194955: 1296227, 1668608354314194956: 1296228, 1668608354314194957: 1296229, 1668608354314194958: 1296230, 1668608354314194959: 1296231, 1668608354314194960: 1296232, 1668608354314194961: 1296233, 1668608354314194962: 1296234, 1668608354314194963: 1296236, 1668608354314194964: 1296237, 1668608354314194965: 1296239, 1668608354314194966: 1296240, 1668608354314194967: 1296241, 1668608354314194968: 1296242, 1668608354314194969: 1296245, 1668608354314194970: 1296248, 1668608354314194971: 1296250, 1668608354314194972: 1296251, 1668608354314194973: 1296253, 1668608354314194974: 1296254, 1668608354314194975: 1296255, 1668608354314194976: 1296256, 1668608354314194977: 1296257, 1668608354314194978: 1296258, 1668608354314194979: 1296259, 1668608354314194980: 1296260, 1668608354314194981: 1296261, 1668608354314194982: 1296262, 1668608354314194983: 1296264, 1668608354314194984: 1296265, 1668608354314194985: 1296267, 1668608354314194986: 1296268, 1668608354314194987: 1296270, 1668608354314194988: 1296271, 1668608354314194989: 1296272, 1668608354314194990: 1296273, 1668608354314194991: 1296274, 1668608354314194992: 1296275, 1668608354314194993: 1296276, 1668608354314194994: 1296277, 1668608354314194995: 1296279, 1668608354314194996: 1296280, 1668608354314194997: 1296281, 1668608354314194998: 1296282}
IDMap = {1294989: 1, 1294990: 2, 1294993: 3, 1294994: 4, 1294995: 5, 1294996: 6, 1294997: 7, 1294998: 8, 1295000: 9, 1295001: 10, 1295002: 11, 1295003: 12, 1295005: 13, 1295006: 14, 1295008: 15, 1295010: 16, 1295012: 17, 1295013: 18, 1295015: 19, 1295016: 20, 1295017: 21, 1295018: 22, 1295019: 23, 1295020: 24, 1295021: 25, 1295022: 26, 1295023: 27, 1295024: 28, 1295025: 29, 1295026: 30, 1295027: 31, 1295028: 32, 1295029: 33, 1295030: 34, 1295032: 35, 1295033: 36, 1295035: 37, 1295037: 38, 1295038: 39, 1295040: 40, 1295041: 41, 1295042: 42, 1295043: 43, 1295044: 44, 1295046: 45, 1295047: 46, 1295048: 47, 1295049: 48, 1295050: 49, 1295051: 50, 1295052: 51, 1295054: 52, 1295056: 53, 1295057: 54, 1295058: 55, 1295059: 56, 1295060: 57, 1295061: 58, 1295062: 59, 1295063: 60, 1295064: 61, 1295065: 62, 1295066: 63, 1295067: 64, 1295068: 65, 1295069: 66, 1295070: 67, 1295073: 68, 1295074: 69, 1295075: 70, 1295076: 71, 1295077: 72, 1295078: 73, 1295079: 74, 1295080: 75, 1295081: 76, 1295082: 77, 1295083: 78, 1295085: 79, 1295087: 80, 1295088: 81, 1295089: 82, 1295090: 83, 1295091: 84, 1295092: 85, 1295093: 86, 1295096: 87, 1295097: 88, 1295098: 89, 1295099: 90, 1295100: 91, 1295103: 92, 1295104: 93, 1295105: 94, 1295106: 95, 1295108: 96, 1295111: 97, 1295112: 98, 1295113: 99, 1295114: 100, 1295115: 101, 1295116: 102, 1295117: 103, 1295118: 104, 1295119: 105, 1295120: 106, 1295121: 107, 1295122: 108, 1295123: 109, 1295124: 110, 1295125: 111, 1295126: 112, 1295127: 113, 1295128: 114, 1295129: 115, 1295131: 116, 1295132: 117, 1295134: 118, 1295135: 119, 1295136: 120, 1295137: 121, 1295138: 122, 1295139: 123, 1295140: 124, 1295141: 125, 1295142: 126, 1295143: 127, 1295144: 128, 1295146: 129, 1295147: 130, 1295148: 131, 1295149: 132, 1295151: 133, 1295152: 134, 1295153: 135, 1295156: 136, 1295157: 137, 1295158: 138, 1295159: 139, 1295161: 140, 1295162: 141, 1295163: 142, 1295165: 143, 1295166: 144, 1295167: 145, 1295168: 146, 1295169: 147, 1295171: 148, 1295173: 149, 1295174: 150, 1295175: 151, 1295176: 152, 1295178: 153, 1295179: 154, 1295181: 155, 1295182: 156, 1295186: 157, 1295187: 158, 1295188: 159, 1295189: 160, 1295191: 161, 1295192: 162, 1295194: 163, 1295195: 164, 1295197: 165, 1295198: 166, 1295199: 167, 1295200: 168, 1295201: 169, 1295202: 170, 1295203: 171, 1295204: 172, 1295205: 173, 1295206: 174, 1295210: 175, 1295212: 176, 1295214: 177, 1295215: 178, 1295216: 179, 1295217: 180, 1295218: 181, 1295219: 182, 1295220: 183, 1295221: 184, 1295223: 185, 1295224: 186, 1295225: 187, 1295226: 188, 1295227: 189, 1295228: 190, 1295229: 191, 1295230: 192, 1295231: 193, 1295232: 194, 1295234: 195, 1295235: 196, 1295236: 197, 1295237: 198, 1295238: 199, 1295240: 200, 1295244: 201, 1295245: 202, 1295247: 203, 1295248: 204, 1295249: 205, 1295251: 206, 1295252: 207, 1295254: 208, 1295255: 209, 1295256: 210, 1295257: 211, 1295259: 212, 1295260: 213, 1295261: 214, 1295262: 215, 1295263: 216, 1295264: 217, 1295265: 218, 1295266: 219, 1295267: 220, 1295268: 221, 1295271: 222, 1295272: 223, 1295273: 224, 1295275: 225, 1295278: 226, 1295279: 227, 1295281: 228, 1295282: 229, 1295283: 230, 1295285: 231, 1295287: 232, 1295288: 233, 1295289: 234, 1295290: 235, 1295291: 236, 1295292: 237, 1295296: 238, 1295297: 239, 1295298: 240, 1295299: 241, 1295300: 242, 1295301: 243, 1295302: 244, 1295303: 245, 1295305: 246, 1295306: 247, 1295307: 248, 1295308: 249, 1295309: 250, 1295312: 251, 1295313: 252, 1295314: 253, 1295315: 254, 1295316: 255, 1295317: 256, 1295318: 257, 1295319: 258, 1295320: 259, 1295322: 260, 1295323: 261, 1295324: 262, 1295327: 263, 1295328: 264, 1295329: 265, 1295332: 266, 1295333: 267, 1295334: 268, 1295335: 269, 1295336: 270, 1295337: 271, 1295338: 272, 1295339: 273, 1295340: 274, 1295341: 275, 1295342: 276, 1295343: 277, 1295344: 278, 1295345: 279, 1295346: 280, 1295347: 281, 1295348: 282, 1295351: 283, 1295353: 284, 1295355: 285, 1295356: 286, 1295357: 287, 1295358: 288, 1295359: 289, 1295360: 290, 1295361: 291, 1295363: 292, 1295364: 293, 1295365: 294, 1295366: 295, 1295367: 296, 1295369: 297, 1295370: 298, 1295371: 299, 1295372: 300, 1295373: 301, 1295374: 302, 1295375: 303, 1295376: 304, 1295377: 305, 1295379: 306, 1295380: 307, 1295381: 308, 1295382: 309, 1295383: 310, 1295386: 311, 1295387: 312, 1295388: 313, 1295389: 314, 1295390: 315, 1295391: 316, 1295392: 317, 1295393: 318, 1295394: 319, 1295395: 320, 1295396: 321, 1295398: 322, 1295399: 323, 1295400: 324, 1295401: 325, 1295402: 326, 1295403: 327, 1295404: 328, 1295405: 329, 1295406: 330, 1295407: 331, 1295408: 332, 1295409: 333, 1295410: 334, 1295412: 335, 1295413: 336, 1295415: 337, 1295416: 338, 1295417: 339, 1295418: 340, 1295421: 341, 1295424: 342, 1295425: 343, 1295426: 344, 1295427: 345, 1295429: 346, 1295430: 347, 1295431: 348, 1295432: 349, 1295433: 350, 1295434: 351, 1295435: 352, 1295436: 353, 1295437: 354, 1295439: 355, 1295441: 356, 1295442: 357, 1295444: 358, 1295445: 359, 1295446: 360, 1295447: 361, 1295448: 362, 1295449: 363, 1295450: 364, 1295451: 365, 1295453: 366, 1295454: 367, 1295457: 368, 1295458: 369, 1295460: 370, 1295461: 371, 1295462: 372, 1295463: 373, 1295464: 374, 1295465: 375, 1295466: 376, 1295468: 377, 1295470: 378, 1295471: 379, 1295472: 380, 1295473: 381, 1295474: 382, 1295475: 383, 1295476: 384, 1295477: 385, 1295478: 386, 1295479: 387, 1295480: 388, 1295481: 389, 1295482: 390, 1295483: 391, 1295484: 392, 1295485: 393, 1295486: 394, 1295488: 395, 1295489: 396, 1295491: 397, 1295492: 398, 1295494: 399, 1295495: 400, 1295496: 401, 1295497: 402, 1295501: 403, 1295502: 404, 1295503: 405, 1295504: 406, 1295505: 407, 1295507: 408, 1295509: 409, 1295510: 410, 1295511: 411, 1295512: 412, 1295513: 413, 1295514: 414, 1295515: 415, 1295516: 416, 1295517: 417, 1295518: 418, 1295519: 419, 1295520: 420, 1295522: 421, 1295523: 422, 1295524: 423, 1295529: 424, 1295531: 425, 1295532: 426, 1295533: 427, 1295534: 428, 1295535: 429, 1295536: 430, 1295539: 431, 1295540: 432, 1295542: 433, 1295543: 434, 1295544: 435, 1295545: 436, 1295546: 437, 1295547: 438, 1295548: 439, 1295549: 440, 1295551: 441, 1295552: 442, 1295554: 443, 1295555: 444, 1295557: 445, 1295558: 446, 1295559: 447, 1295560: 448, 1295561: 449, 1295562: 450, 1295564: 451, 1295565: 452, 1295566: 453, 1295568: 454, 1295569: 455, 1295570: 456, 1295571: 457, 1295572: 458, 1295574: 459, 1295575: 460, 1295577: 461, 1295578: 462, 1295579: 463, 1295580: 464, 1295582: 465, 1295586: 466, 1295587: 467, 1295589: 468, 1295593: 469, 1295595: 470, 1295596: 471, 1295597: 472, 1295598: 473, 1295600: 474, 1295601: 475, 1295602: 476, 1295604: 477, 1295605: 478, 1295607: 479, 1295608: 480, 1295609: 481, 1295611: 482, 1295613: 483, 1295614: 484, 1295615: 485, 1295616: 486, 1295617: 487, 1295618: 488, 1295619: 489, 1295620: 490, 1295622: 491, 1295623: 492, 1295626: 493, 1295628: 494, 1295629: 495, 1295630: 496, 1295631: 497, 1295632: 498, 1295633: 499, 1295635: 500, 1295636: 501, 1295637: 502, 1295638: 503, 1295639: 504, 1295640: 505, 1295641: 506, 1295642: 507, 1295643: 508, 1295644: 509, 1295647: 510, 1295648: 511, 1295649: 512, 1295650: 513, 1295652: 514, 1295653: 515, 1295654: 516, 1295655: 517, 1295656: 518, 1295657: 519, 1295658: 520, 1295659: 521, 1295660: 522, 1295661: 523, 1295662: 524, 1295663: 525, 1295664: 526, 1295666: 527, 1295667: 528, 1295669: 529, 1295670: 530, 1295671: 531, 1295672: 532, 1295674: 533, 1295675: 534, 1295676: 535, 1295677: 536, 1295678: 537, 1295679: 538, 1295680: 539, 1295681: 540, 1295682: 541, 1295683: 542, 1295684: 543, 1295686: 544, 1295687: 545, 1295688: 546, 1295689: 547, 1295691: 548, 1295693: 549, 1295694: 550, 1295695: 551, 1295696: 552, 1295697: 553, 1295698: 554, 1295701: 555, 1295702: 556, 1295703: 557, 1295707: 558, 1295708: 559, 1295710: 560, 1295711: 561, 1295712: 562, 1295713: 563, 1295714: 564, 1295716: 565, 1295717: 566, 1295719: 567, 1295722: 568, 1295723: 569, 1295724: 570, 1295725: 571, 1295726: 572, 1295727: 573, 1295728: 574, 1295729: 575, 1295730: 576, 1295731: 577, 1295733: 578, 1295734: 579, 1295735: 580, 1295736: 581, 1295737: 582, 1295738: 583, 1295740: 584, 1295741: 585, 1295742: 586, 1295744: 587, 1295747: 588, 1295748: 589, 1295749: 590, 1295750: 591, 1295752: 592, 1295753: 593, 1295754: 594, 1295755: 595, 1295757: 596, 1295758: 597, 1295759: 598, 1295761: 599, 1295762: 600, 1295763: 601, 1295764: 602, 1295765: 603, 1295766: 604, 1295768: 605, 1295769: 606, 1295771: 607, 1295772: 608, 1295773: 609, 1295774: 610, 1295777: 611, 1295779: 612, 1295781: 613, 1295782: 614, 1295783: 615, 1295784: 616, 1295785: 617, 1295786: 618, 1295787: 619, 1295788: 620, 1295789: 621, 1295790: 622, 1295791: 623, 1295792: 624, 1295793: 625, 1295794: 626, 1295795: 627, 1295797: 628, 1295798: 629, 1295799: 630, 1295800: 631, 1295803: 632, 1295804: 633, 1295806: 634, 1295807: 635, 1295808: 636, 1295810: 637, 1295811: 638, 1295812: 639, 1295814: 640, 1295815: 641, 1295816: 642, 1295817: 643, 1295818: 644, 1295819: 645, 1295820: 646, 1295821: 647, 1295822: 648, 1295823: 649, 1295824: 650, 1295825: 651, 1295826: 652, 1295827: 653, 1295828: 654, 1295829: 655, 1295830: 656, 1295831: 657, 1295832: 658, 1295835: 659, 1295836: 660, 1295837: 661, 1295838: 662, 1295840: 663, 1295844: 664, 1295846: 665, 1295847: 666, 1295849: 667, 1295850: 668, 1295851: 669, 1295852: 670, 1295853: 671, 1295854: 672, 1295855: 673, 1295857: 674, 1295858: 675, 1295859: 676, 1295860: 677, 1295862: 678, 1295864: 679, 1295865: 680, 1295866: 681, 1295867: 682, 1295868: 683, 1295869: 684, 1295870: 685, 1295871: 686, 1295872: 687, 1295873: 688, 1295874: 689, 1295875: 690, 1295877: 691, 1295878: 692, 1295879: 693, 1295880: 694, 1295882: 695, 1295883: 696, 1295884: 697, 1295885: 698, 1295887: 699, 1295889: 700, 1295890: 701, 1295891: 702, 1295893: 703, 1295894: 704, 1295895: 705, 1295896: 706, 1295897: 707, 1295899: 708, 1295901: 709, 1295902: 710, 1295903: 711, 1295904: 712, 1295905: 713, 1295906: 714, 1295911: 715, 1295912: 716, 1295915: 717, 1295916: 718, 1295917: 719, 1295918: 720, 1295919: 721, 1295920: 722, 1295921: 723, 1295924: 724, 1295925: 725, 1295926: 726, 1295928: 727, 1295929: 728, 1295930: 729, 1295931: 730, 1295932: 731, 1295933: 732, 1295934: 733, 1295935: 734, 1295936: 735, 1295937: 736, 1295938: 737, 1295939: 738, 1295941: 739, 1295942: 740, 1295943: 741, 1295944: 742, 1295945: 743, 1295947: 744, 1295948: 745, 1295949: 746, 1295950: 747, 1295952: 748, 1295954: 749, 1295955: 750, 1295956: 751, 1295958: 752, 1295959: 753, 1295961: 754, 1295962: 755, 1295963: 756, 1295964: 757, 1295965: 758, 1295966: 759, 1295967: 760, 1295968: 761, 1295969: 762, 1295970: 763, 1295971: 764, 1295972: 765, 1295973: 766, 1295974: 767, 1295975: 768, 1295976: 769, 1295977: 770, 1295978: 771, 1295980: 772, 1295981: 773, 1295982: 774, 1295983: 775, 1295985: 776, 1295986: 777, 1295987: 778, 1295988: 779, 1295990: 780, 1295992: 781, 1295993: 782, 1295996: 783, 1295997: 784, 1295998: 785, 1296000: 786, 1296002: 787, 1296003: 788, 1296005: 789, 1296006: 790, 1296007: 791, 1296010: 792, 1296011: 793, 1296012: 794, 1296013: 795, 1296014: 796, 1296015: 797, 1296017: 798, 1296018: 799, 1296019: 800, 1296020: 801, 1296021: 802, 1296022: 803, 1296023: 804, 1296024: 805, 1296025: 806, 1296026: 807, 1296027: 808, 1296028: 809, 1296029: 810, 1296030: 811, 1296032: 812, 1296033: 813, 1296035: 814, 1296036: 815, 1296037: 816, 1296038: 817, 1296039: 818, 1296040: 819, 1296042: 820, 1296043: 821, 1296045: 822, 1296046: 823, 1296047: 824, 1296048: 825, 1296049: 826, 1296050: 827, 1296052: 828, 1296053: 829, 1296054: 830, 1296055: 831, 1296057: 832, 1296058: 833, 1296060: 834, 1296062: 835, 1296063: 836, 1296064: 837, 1296065: 838, 1296066: 839, 1296067: 840, 1296068: 841, 1296069: 842, 1296071: 843, 1296073: 844, 1296074: 845, 1296075: 846, 1296076: 847, 1296077: 848, 1296078: 849, 1296079: 850, 1296080: 851, 1296082: 852, 1296083: 853, 1296084: 854, 1296087: 855, 1296088: 856, 1296090: 857, 1296092: 858, 1296094: 859, 1296095: 860, 1296096: 861, 1296097: 862, 1296099: 863, 1296100: 864, 1296101: 865, 1296102: 866, 1296104: 867, 1296105: 868, 1296106: 869, 1296107: 870, 1296108: 871, 1296109: 872, 1296110: 873, 1296111: 874, 1296114: 875, 1296115: 876, 1296118: 877, 1296119: 878, 1296121: 879, 1296122: 880, 1296125: 881, 1296126: 882, 1296127: 883, 1296128: 884, 1296129: 885, 1296130: 886, 1296131: 887, 1296133: 888, 1296134: 889, 1296135: 890, 1296136: 891, 1296137: 892, 1296138: 893, 1296139: 894, 1296140: 895, 1296141: 896, 1296142: 897, 1296143: 898, 1296144: 899, 1296145: 900, 1296147: 901, 1296148: 902, 1296149: 903, 1296152: 904, 1296154: 905, 1296155: 906, 1296156: 907, 1296157: 908, 1296158: 909, 1296161: 910, 1296162: 911, 1296163: 912, 1296164: 913, 1296168: 914, 1296169: 915, 1296170: 916, 1296171: 917, 1296172: 918, 1296173: 919, 1296175: 920, 1296176: 921, 1296177: 922, 1296179: 923, 1296184: 924, 1296185: 925, 1296187: 926, 1296189: 927, 1296190: 928, 1296192: 929, 1296193: 930, 1296195: 931, 1296197: 932, 1296199: 933, 1296200: 934, 1296201: 935, 1296202: 936, 1296203: 937, 1296204: 938, 1296206: 939, 1296207: 940, 1296208: 941, 1296209: 942, 1296210: 943, 1296211: 944, 1296212: 945, 1296213: 946, 1296217: 947, 1296218: 948, 1296219: 949, 1296220: 950, 1296221: 951, 1296222: 952, 1296223: 953, 1296225: 954, 1296226: 955, 1296227: 956, 1296228: 957, 1296229: 958, 1296230: 959, 1296231: 960, 1296232: 961, 1296233: 962, 1296234: 963, 1296236: 964, 1296237: 965, 1296239: 966, 1296240: 967, 1296241: 968, 1296242: 969, 1296245: 970, 1296248: 971, 1296250: 972, 1296251: 973, 1296253: 974, 1296254: 975, 1296255: 976, 1296256: 977, 1296257: 978, 1296258: 979, 1296259: 980, 1296260: 981, 1296261: 982, 1296262: 983, 1296264: 984, 1296265: 985, 1296267: 986, 1296268: 987, 1296270: 988, 1296271: 989, 1296272: 990, 1296273: 991, 1296274: 992, 1296275: 993, 1296276: 994, 1296277: 995, 1296279: 996, 1296280: 997, 1296281: 998, 1296282: 999}


# 表单搜索结果显示
def search_form(request):
    return render(request, 'search_form.html')


def milvus_query(query_content):
    __HOST = '127.0.0.1'
    __PORT = '19530'
    __DIM = 768
    __INDEX_FILE_SIZE = 32
    vector = model(tokenizer.encode(query_content, return_tensors="pt")).pooler_output.detach().numpy().squeeze()
    vector = list(vector)
    result = str(len(vector))+str(vector[0])+str(vector[99])

    milvus = Milvus(__HOST, __PORT)
    message = ""
    search_param = {
                "nprobe": 16
        }
    param = {
            'collection_name': 'MinHang_Law_Vector_Test_768',
            'query_records': [vector],
            'top_k': 5,
            'params': search_param,
            }
    status, results = milvus.search(**param)
    try:
        result =  "ID:"+ str(IDMap[MiMap[results[0][0].id]]) + "<br/>"
        result += "案件名称:" + str(df['name'][IDMap[MiMap[results[0][0].id]] -1]) + "<br/>"
        result +="罪名：" + str(df['cause_of_action'][IDMap[MiMap[results[0][0].id]] -1 ]) + "<br/>"
        result += "类型：" + str(df['type'][IDMap[MiMap[results[0][0].id]] - 1]) + "<br/>"
        result += "全文：" +str(df['doc'][IDMap[MiMap[results[0][0].id]] - 1]) + "<br/>"
        result += "<br/>" + "_______________________________________________其余四条ID:" + "<br/>"
        for i in range(1,5):
            result += "ID:" + str(IDMap[MiMap[results[0][i].id]]) + "对应名称:"
            result += str(df['name'][IDMap[MiMap[results[0][i].id]] -1]) + "<br/>"

    except:
        message = "INPUT ERROR"
        result = results[0][0].id
        # vector = [float(ord(query_content[0]))/26-ord('a')/26 , float(ord(query_content[1]))/26-ord('a')/26 , float(ord(query_content[2]))/26-ord('a')/26]
        # search_param = {
        #     "nprobe": 16
        # }
        # param = {
        #     'collection_name': 'three_dimension_demo',
        #     'query_records': vector,
        #     'top_k': 5,
        #     'params': search_param,
        # }
        # status, results = vcedDemoLearn.search(**param)
        # if status.OK():
        #     message = results
        # else:
        #     message = "Search failed. " + status


    return message , result

# 接收请求数据
def search(request):
    request.encoding = 'utf-8'
    if 'q' in request.GET and request.GET['q']:
        message, result = milvus_query(request.GET['q'])
        message = "你搜索的内容为：<br/>"+ message + '<br/>' + result
        # 可以在这里加入Milvus的服务，渲染一个Milvus处理的结果


    else:
        message = "你提交了空表单"

    return HttpResponse(message)


# def milvus_build(name, metric_type=None):
#     vcedDemoLearn = Milvus(__HOST, __PORT)
#     collection_name = name
#
#     status, ok = vcedDemoLearn.has_collection(collection_name)
#
#     if not ok:
#         param = {
#             'collection_name': collection_name,
#             'dimension': __DIM,
#             'index_file_size': __INDEX_FILE_SIZE,  # optional
#             'metric_type': MetricType.L2 if metric_type == None else metric_type  # optional
#         }
#
#         vcedDemoLearn.create_collection(param)
#         print("Create " + name + " Successfully")
#
#     _, collections = vcedDemoLearn.list_collections()
#     print("Now our collections list: \n", [content + '\n' for content in collections])
#
#     return vcedDemoLearn

def build_query_with_vector(milvus,index,vectors):

     pass




